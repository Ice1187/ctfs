def xor(x, y):
  if len(x) > len(y):
    x, y = y, x
  ans = b''
  for i in range(len(y)):
    ans += (y[i] ^ x[i % len(x)]).to_bytes(1, 'little')
  return ans

enc_flag = b'gYs\xc3f^\xace.\x0e0\xec\x17j\xab\x96\xd8\x98\xcc\x98\xa0\x11Pko\x90h\xe8\xb2rk\x95\x05\x1fK\x9ac\x97Q>\x05\xc7\xcc;m\xb7b\x08\xce\xd5\x05m\x9bo\xfe\x1c\x98o\xe1\xf6\xa8\xce\nU'

msg = b'A'*0x30
enc_msg = b'~5\x7f\xc3td\xa9\x14\x01x.\xf4f^\xb5\xe4\xef\xea\xff\x86\xb6" ^K\x8ez\x98\x9d\x05F\xb101d\xee}\x90 \r\x1b\xb6\xf9\ns\xb1\x10\'\xea\xe6pX\xb5\\\x8a\x02\xe9\x16\xc8\xd3\x83\xbeyi~\x95\x8d\xfb:\xe9#\xa1?\xd0\x18c\x0c\xc5\xd0\x8f\xd8\xa6j(fxd\xc9\xd3_G\xe5\x12PW5'

key = xor(msg, enc_msg)
print(key)

flag = xor(key, enc_flag)
flag = flag[flag.find(b'X-MAS'):flag.find(b'}')+1].decode()
print(flag)
